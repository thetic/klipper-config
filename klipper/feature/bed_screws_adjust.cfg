[bed_screws]

[menu __main __setup __calib __bed_screws_adjust]
type: list
name: Bed Screws
enable: {('bed_screws' in printer) and (not printer.idle_timeout.state == "Printing")}

[menu __main __setup __calib __bed_screws_adjust __adjust_screws]
type: command
name: Start
gcode:
    {% if "xyz" not in printer.toolhead.homed_axes %}
        G28
    {% endif %}
    BED_SCREWS_ADJUST
enable: {not printer.idle_timeout.state == "Printing"}

[menu __main __setup __calib __bed_screws_adjust __screw_adjusted]
type: command
name: ADJUSTED
gcode: ADJUSTED
enable: {not printer.idle_timeout.state == "Printing"}

[menu __main __setup __calib __bed_screws_adjust __screw_accept]
type: command
name: ACCEPT
gcode: ACCEPT
enable: {not printer.idle_timeout.state == "Printing"}

[menu __main __setup __calib __bed_screws_adjust __bed_screws_adjust_abort]
type: command
name: ABORT
gcode: ABORT
enable: {not printer.idle_timeout.state == "Printing"}

[gcode_macro BED_SCREWS_ADJUST]
description: Tool to help adjust bed leveling screws
rename_existing: _BED_SCREWS_ADJUST
gcode:
    {% if 'STATUS_LEVELING' in printer.gcode.commands %}
        STATUS_LEVELING
    {% endif %}
    _BED_SCREWS_ADJUST
    {% if 'STATUS_READY' in printer.gcode.commands %}
        STATUS_READY
    {% endif %}