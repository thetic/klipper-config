[bed_mesh]

[gcode_macro BED_MESH_CALIBRATE]
rename_existing: _BED_MESH_CALIBRATE
gcode:
    {% if '_CheckProbe' in printer.gcode.commands %}
        _CheckProbe action=query
        G90
        ATTACH_PROBE
    {% endif %}

    {% if 'STATUS_MESHING' in printer.gcode.commands %}
        STATUS_MESHING
    {% endif %}

    _BED_MESH_CALIBRATE {rawparams}

    {% if '_CheckProbe' in printer.gcode.commands %}
        DOCK_PROBE
    {% endif %}

    {% if 'STATUS_READY' in printer.gcode.commands %}
        STATUS_READY
    {% endif %}
